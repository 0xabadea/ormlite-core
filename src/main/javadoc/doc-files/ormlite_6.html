<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created on March, 29 2011 by texi2html 1.70 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<head>
<title>ORMLite Package: 6. Upgrade From Old Versions</title>

<meta name="description" content="ORMLite Package: 6. Upgrade From Old Versions">
<meta name="keywords" content="ORMLite Package: 6. Upgrade From Old Versions">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.70">
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="NOD49"></a>
<a name="SEC48"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="ormlite_5.html#SEC47" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC49" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="ormlite_5.html#SEC40" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="ormlite.html#SEC_Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="ormlite_7.html#SEC54" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="ormlite.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_10.html#SEC59" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1 class="chapter"> 6. Upgrade From Old Versions </h1>

<p>We strive to maintain backwards compatibility and to provide deprecated versions of old classes and methods.
However, sometimes when a new version is released, changes are made that require programmers to change their code
and rarely the on-disk database formats. 

</p><table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#SEC49">6.1 Upgrade to Version 4.14</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Upgrade to version 4.14
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC50">6.2 Upgrade to Version 4.10</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Upgrade to version 4.10
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC51">6.3 Upgrade to Version 4.0</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Upgrade to version 4.0
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC52">6.4 Upgrade to Version 3.2</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Upgrade to version 3.2
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC53">6.5 Upgrade to Version 2.4</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Upgrade to version 2.4
</td></tr>
</table>

<hr size="6">
<a name="NOD50"></a>
<a name="SEC49"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC48" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC50" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC48" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC48" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="ormlite_7.html#SEC54" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="ormlite.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_10.html#SEC59" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 6.1 Upgrade to Version 4.14 </h2>

<p>In 4.14 we added a <code>DatabaseType.BYTE_ARRAY</code> which stores <code>byte[]</code> directly.  See <a href="ormlite_2.html#ANC12">BYTE_ARRAY</a>.  In the past, this array
would have been stored as a serialized array of bytes.  To not break backwards compatibility with the database, fields with the
<code>byte[]</code> type <em>must</em> now specify either the <code>BYTE_ARRAY</code> or <code>SERIALIZABLE</code> types using the <code>dataType</code> field
on <code>@DatabaseField</code> - it will not be chosen automatically.  See <a href="ormlite_2.html#ANC2">DatabaseField dataType</a>.  If we did not do this then
previously stored data would be read from the database improperly.

</p><p>In addition, serialized types must also now specify their <code>dataType</code> value.  You should use <code>DataType.SERIALIZABLE</code> to
continue to store serialized objects in the database.  This will allow us to add direct support for other serialized types in the
future without breaking backwards compatibility.

</p><p>If you already have Serializable data (byte[] or other objects) stored in a database then you will need to add something like the
following to your fields:

</p><table><tr><td>&nbsp;</td><td><pre class="example">@DatabaseField(dataType = DataType.SERIALIZABLE)
Serializable field;
</pre></td></tr></table>
<p>For newly stored byte[] fields, you could use the BYTE_ARRAY type to store the bytes directly.  But any existing data will <em>not</em>
be converted automatically.

</p><table><tr><td>&nbsp;</td><td><pre class="example">@DatabaseField(dataType = DataType.BYTE_ARRAY)
byte[] field;
</pre></td></tr></table>
<hr size="6">
<a name="NOD51"></a>
<a name="SEC50"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC49" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC51" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC48" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC48" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="ormlite_7.html#SEC54" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="ormlite.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_10.html#SEC59" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 6.2 Upgrade to Version 4.10 </h2>

<p>4.10 was a reasonably large release containing some feature upgrades and some bug fixes.  No data formats were changed, however
the following API code was altered:

</p><ul>
<li><p> We significantly refactored the <code>RawResults</code> class which is now deprecated and replaced it with the <code>GenericRawResults</code>
class.  See the <code>GenericRawResults</code> for more information.  See section <a href="ormlite_2.html#SEC23">Issuing Raw Queries</a>.  

</p></li><li><p> The <code>Dao</code> methods <code>queryForAllRaw()</code> and <code>iteratorRaw()</code> are now deprecated.  They are replaced with <code>queryRaw()</code>
methods.  See the <code>Dao</code> class javadocs for more information. 

</p></li><li><p> Before this release the -jdbc and -android versions of ORMLite contained the -core functionality.  In this release we split
out the -core from the other packages so you will now need to install <em>both</em> the core and android (or jdbc) packages to get the package
to work.

</p></li></ul>

<hr size="6">
<a name="NOD52"></a>
<a name="SEC51"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC50" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC52" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC48" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC48" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="ormlite_7.html#SEC54" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="ormlite.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_10.html#SEC59" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 6.3 Upgrade to Version 4.0 </h2>

<p>No data formats were changed, however the following API code was altered.  Removed any outside usage of the <code>DatabaseType</code> since the
<code>ConnectionSource</code> now provides it.  Also added features to be able to prepare update and delete statements.  To provide type safety,
we've moved back to using <code>QueryBuilder</code> so we can have <code>UpdateBuilder</code> and <code>DeleteBuilder</code>.  And instead of a
<code>PreparedStmt</code> there is <code>PreparedQuery</code>, <code>PreparedUpdate</code>, and <code>PreparedDelete</code>.  Here are the details:

</p><ul>
<li><p> We have removed most of the cases where the user has to deal with the <code>DatabaseType</code>.
All you need to set on the DAOs is the <code>ConnectionSource</code> which provides the database type 
internally.  To create and drop the tables, also, you only need the <code>ConnectionSource</code>.

</p></li><li><p> Constructing a <code>BaseDaoImpl</code> now self-initializes if it is constructed with a
<code>ConnectionSource</code>.  This validates the class configurations meaning that it now throws a
<code>SQLException</code>.

</p></li><li><p> Constructing a <code>JdbcConnectionSource</code> or <code>DataSourceConnectionSource</code> also now
throws a <code>SQLException</code> since they also now self-initialize if they are constructed with the URL.
This creates the internal database type and loads the driver class for it.  

</p></li><li><p> Deprecated the <code>createJdbcConnectionSource</code> method in the <code>DatabaseTypeUtils</code> and
turned the <code>loadDriver</code> method into a no-op.  You now just instantiate the <code>JdbcConnectionSource</code>
directly and there is no need for referencing the <code>DatabaseTypeUtils</code> anymore.

</p></li><li><p> <code>Dao.statementBuilder()</code> method changed (back) to <code>Dao.queryBuilder()</code>.

</p></li><li><p> <code>Dao.queryBuilder()</code> returns a <code>QueryBuilder</code> instead of a <code>StatementBuilder</code>.

</p></li><li><p> You now call <code>distinct()</code>, <code>limit()</code> and <code>offset()</code> on the <code>QueryBuilder</code>.
Unfortunately, there are no deprecated methods for them on the <code>StatementBuilder</code>.

</p></li><li><p> You now call <code>selectColumns()</code> on the <code>QueryBuilder</code> instead of <code>columns()</code>
since now we have columns also in the <code>UpdateBuilder</code>.  Unfortunately, there are no deprecated
methods for them on the <code>StatementBuilder</code>.

</p></li><li><p> You call <code>QueryBuilder.prepare()</code> instead of <code>StatementBuilder.prepareStatement()</code>.
It returns a <code>PreparedQuery</code> instead of a <code>PreparedStmt</code>.  You pass a <code>PreparedQuery</code>
into the <code>Dao.query()</code> and <code>Dao.iterator()</code> methods instead of a <code>PreparedStmt</code>.

</p></li><li><p> We removed the <code>DatabaseTypeFactory</code> class since it was no longer needed for Spring
configurations.

</p></li><li><p> Removed <code>BaseJdbcDao</code> since it had been deprecated in 3.X.

</p></li></ul>

<hr size="6">
<a name="NOD53"></a>
<a name="SEC52"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC51" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC53" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC48" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC48" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="ormlite_7.html#SEC54" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="ormlite.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_10.html#SEC59" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 6.4 Upgrade to Version 3.2 </h2>

<p>The 3.2 release involved a <em>very</em> large code reorganization and migration.  There were no on-disk changes unless you somehow
managed to get ORMLite working previously on Android.  The project was basically split into 3 pieces: core functionality, JDBC
database handlers, and the new Android handler.  With significant help from Kevin G, we abstracted all of the database calls into
3 interfaces: <code>ConnectionSource</code> (like a <code>DataSource</code>), <code>DatabaseConnection</code> (like a <code>Connection</code>) and
<code>DatabaseResults</code> (like a <code>ResultSet</code>).  Once we had the interfaces in place, we wrote delegation classes for JDBC and
Android handlers.  This means that as of 3.X we release 3 packages: ormlite-core (for developers), ormlite-jdbc (for people
connecting to JDBC databases), and ormlite-android (for Android users).  Both the JDBC and Android packages include all of the
core code as well.

</p><p>Along the way a number of specific changes were made to the methods and classes:

</p><ul>
<li><p> Since we split off the JDBC, we renamed the <code>BaseJdbcDao</code> to be <code>BaseDaoImpl</code> in the core package. You will
need to adjust any DAOs that you have.

</p></li><li><p> We are in the process of allowing custom delete and update methods so we took the major upgrade opportunity to
rename the <code>QueryBuilder</code> object to be <code>StatementBuilder</code>.  <em>NOTE:</em> this was reverted later.

</p></li><li><p> Because of the above, we also renamed <code>Dao.queryBuilder()</code> method to be <code>statementBuilder()</code>.  <em>NOTE:</em> this
was reverted later.

</p></li><li><p> Also renamed the <code>PreparedQuery</code> object to be <code>PreparedStmt</code>.

</p></li><li><p> One of the big changes for those of you using an external JDBC <code>DataSource</code> is that you no longer set it on the
DAO directly.  You need to wrap your <code>DataSource</code> in a <code>DataSourceDatabaseConnection</code> wrapper class which gets
set on the DAO instead.

</p></li></ul>

<p>Again, there were no on-disk changes unless you somehow managed to get ORMLite working previously on Android.  Since we were using
JDBC before to do the data marshalling and now are doing it by hand, some of the data representations may have changed.  Sorry for
the lack of detail here.

</p><hr size="6">
<a name="NOD54"></a>
<a name="SEC53"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC52" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="ormlite_7.html#SEC54" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC48" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC48" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="ormlite_7.html#SEC54" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="ormlite.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_10.html#SEC59" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 6.5 Upgrade to Version 2.4 </h2>

<p>A bug was fixed in 2.4 with how we were handling Derby and Hsqldb.  Both of these databases seem to be capitalizing table and field
names in certain situations which meant that customized queries of ORMLite generated tables were affected.  In version 2.4,
all tables and field names are capitalized in the SQL generated for Derby and Hsqldb databases. This means that if you have data
in these databases from a pre 2.4 version, the 2.4 version will not be able to find the tables and fields without renaming to be
uppercase.

</p><hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC48" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="ormlite_7.html#SEC54" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="ormlite.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_10.html#SEC59" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="ormlite_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>Gray Watson</em> on <em>March, 29 2011</em> using <a href="http://texi2html.cvshome.org/"><em>texi2html 1.70</em></a>.
 </font>
 <br>

</p>
</body>
</html>
